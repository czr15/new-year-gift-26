<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ç»™ä½ çš„æ–°å¹´ç¤¼ç‰©</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Arial Rounded MT Bold', 'Microsoft YaHei', sans-serif;
        }

        body {
            overflow: hidden;
            background: linear-gradient(135deg, #ffecd2 0%, #fcb69f 100%);
            transition: background 1s ease;
        }

        /* éŸ³ä¹æç¤ºå±‚ */
        #music-hint {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.7);
            display: flex;
            justify-content: center;
            align-items: center;
            z-index: 10000;
            opacity: 1;
            transition: opacity 0.5s;
        }

        .hint-box {
            background: white;
            padding: 40px;
            border-radius: 20px;
            text-align: center;
            max-width: 90%;
            box-shadow: 0 20px 50px rgba(0,0,0,0.3);
            animation: popUp 0.5s ease-out;
        }

        @keyframes popUp {
            from { transform: scale(0.8); opacity: 0; }
            to { transform: scale(1); opacity: 1; }
        }

        .hint-box i {
            font-size: 50px;
            color: #ff6b8b;
            margin-bottom: 20px;
            display: block;
        }

        .hint-box h2 {
            color: #333;
            margin-bottom: 15px;
            font-size: 24px;
        }

        .hint-box p {
            color: #666;
            margin-bottom: 25px;
            line-height: 1.5;
        }

        .hint-btn {
            background: linear-gradient(135deg, #ff6b8b, #ff8e53);
            color: white;
            border: none;
            padding: 15px 40px;
            font-size: 18px;
            border-radius: 50px;
            cursor: pointer;
            font-weight: bold;
            letter-spacing: 1px;
            transition: transform 0.3s;
        }

        .hint-btn:hover {
            transform: scale(1.05);
        }

        /* ===== ç¬¬ä¸€å¹•ï¼šç¤¼ç‰©é€‰æ‹© ===== */
        #scene-1 {
            position: fixed;
            width: 100vw;
            height: 100vh;
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            z-index: 100;
            background: linear-gradient(135deg, #ffecd2 0%, #fcb69f 100%);
        }

        .gift-container {
            text-align: center;
            animation: float 3s ease-in-out infinite;
        }

        @keyframes float {
            0%, 100% { transform: translateY(0); }
            50% { transform: translateY(-15px); }
        }

        .gift-emoji {
            font-size: 120px;
            display: block;
            margin-bottom: 25px;
            animation: pulse 2s infinite, rotate 10s linear infinite;
            filter: drop-shadow(0 10px 15px rgba(255, 77, 77, 0.3));
        }

        @keyframes pulse {
            0%, 100% { transform: scale(1); }
            50% { transform: scale(1.1); }
        }

        @keyframes rotate {
            0% { transform: rotateY(0deg); }
            100% { transform: rotateY(360deg); }
        }

        .sparkle {
            position: absolute;
            width: 10px;
            height: 10px;
            background: gold;
            border-radius: 50%;
            animation: sparkleMove 2s linear infinite;
        }

        @keyframes sparkleMove {
            0% { transform: translate(0, 0) scale(0); opacity: 1; }
            100% { transform: translate(var(--tx), var(--ty)) scale(1); opacity: 0; }
        }

        .gift-text {
            font-size: 28px;
            color: #5a3d2b;
            margin-bottom: 40px;
            font-weight: bold;
            letter-spacing: 1.5px;
            text-shadow: 2px 2px 4px rgba(0,0,0,0.1);
            background: linear-gradient(45deg, #ff6b6b, #ffa726);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            padding: 10px 30px;
            border-radius: 50px;
            background-color: rgba(255, 255, 255, 0.2);
            backdrop-filter: blur(10px);
            box-shadow: 0 10px 25px rgba(255, 107, 107, 0.2);
        }

        .gift-text span {
            color: #ff3366;
            text-shadow: 0 2px 5px rgba(255, 51, 102, 0.3);
        }

        .buttons {
            display: flex;
            gap: 30px;
            margin-top: 20px;
        }

        .btn {
            padding: 18px 45px;
            font-size: 20px;
            border: none;
            border-radius: 60px;
            cursor: pointer;
            transition: all 0.3s;
            font-weight: bold;
            letter-spacing: 1.5px;
            position: relative;
            overflow: hidden;
            box-shadow: 0 12px 25px rgba(0,0,0,0.15);
            text-transform: uppercase;
            min-width: 160px;
        }

        .btn::before {
            content: '';
            position: absolute;
            top: 0;
            left: -100%;
            width: 100%;
            height: 100%;
            background: linear-gradient(90deg, transparent, rgba(255,255,255,0.3), transparent);
            transition: 0.5s;
        }

        .btn:hover::before {
            left: 100%;
        }

        .btn-accept {
            background: linear-gradient(135deg, #43e97b, #38f9d7);
            color: white;
            border: 3px solid #2ecc71;
        }

        .btn-reject {
            background: linear-gradient(135deg, #ff6b6b, #ffa726);
            color: white;
            border: 3px solid #e74c3c;
            position: relative;
            transition: all 0.2s;
        }

        .btn:hover {
            transform: translateY(-8px) scale(1.05);
            box-shadow: 0 20px 35px rgba(0,0,0,0.25);
        }

        .btn:active {
            transform: translateY(-2px);
        }

        /* ===== ç¬¬äºŒå¹•ï¼šä¿¡ä»¶é¡µé¢ ===== */
        /* ä¿®æ”¹è¿™é‡Œå¼€å§‹ï¼šæ”¯æŒæ»‘åŠ¨ */
        #scene-2 {
            position: fixed;
            top: 0;
            left: 0;
            width: 100vw;
            height: 100vh;
            background: linear-gradient(135deg, #fff5f7, #ffe8ec);
            display: none;
            z-index: 90;
            opacity: 0;
            transition: opacity 1s;
            overflow-y: auto;        /* å…è®¸å‚ç›´æ»šåŠ¨ */
            padding: 40px 20px;     /* å¢åŠ å†…è¾¹è·ä¾¿äºæ»‘åŠ¨ */
            box-sizing: border-box;
        }

        .letter-container {
            background: rgba(255, 255, 255, 0.97);
            width: 90%;
            max-width: 650px;
            padding: 60px 50px;
            border-radius: 30px;
            box-shadow: 0 30px 80px rgba(255, 107, 139, 0.3);
            position: relative;
            border: 2px solid rgba(255, 182, 193, 0.4);
            transform: scale(0.9);
            animation: letterAppear 1.2s ease-out 0.5s forwards;
            backdrop-filter: blur(15px);
            margin: 0 auto 80px auto;  /* æ°´å¹³å±…ä¸­ï¼Œåº•éƒ¨æœ‰é—´è· */
            box-sizing: border-box;
            min-height: auto;          /* é«˜åº¦è‡ªé€‚åº”å†…å®¹ */
        }

        @keyframes letterAppear {
            0% {
                transform: scale(0.9);
                opacity: 0;
            }
            100% {
                transform: scale(1);
                opacity: 1;
            }
        }
        /* ä¿®æ”¹è¿™é‡Œç»“æŸ */

        .letter-header {
            text-align: center;
            margin-bottom: 40px;
            position: relative;
        }

        .ribbon {
            font-size: 50px;
            color: #ff6b8b;
            margin-bottom: 20px;
            display: block;
            animation: bounce 2s infinite;
        }

        @keyframes bounce {
            0%, 100% { transform: translateY(0); }
            50% { transform: translateY(-10px); }
        }

        .to-name {
            font-size: 36px;
            color: #5a3d2b;
            font-weight: bold;
            letter-spacing: 4px;
            margin-bottom: 15px;
            background: linear-gradient(45deg, #ff6b8b, #ff8e53);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
        }

        .decoration-line {
            width: 200px;
            height: 3px;
            background: linear-gradient(to right, transparent, #ff6b8b, transparent);
            margin: 25px auto;
            border-radius: 3px;
        }

        .letter-content {
            font-size: 22px;
            line-height: 1.9;
            color: #6d4c3d;
            text-align: center;
            white-space: pre-line;
            margin: 50px 0;
            font-weight: 400;
            letter-spacing: 1px;
            padding: 0 20px;
            font-family: 'KaiTi', 'STKaiti', serif;
        }

        .letter-footer {
            text-align: right;
            margin-top: 70px;
            padding-top: 25px;
            border-top: 2px dashed #ffb6c1;
        }

        .from-name {
            font-size: 26px;
            color: #ff6b8b;
            font-style: italic;
            margin-bottom: 12px;
            font-weight: bold;
            letter-spacing: 2px;
        }

        .date {
            font-size: 18px;
            color: #a1887f;
            font-weight: 300;
            letter-spacing: 1px;
        }

        /* ===== é£˜é›ªå’Œçˆ±å¿ƒæ•ˆæœ ===== */
        #snow-canvas, #hearts-canvas {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            pointer-events: none;
            z-index: 1;
        }

        /* ===== éŸ³ä¹æ§åˆ¶ ===== */
        .music-control {
            position: fixed;
            bottom: 30px;
            right: 30px;
            z-index: 1000;
            background: rgba(255, 255, 255, 0.95);
            width: 70px;
            height: 70px;
            border-radius: 50%;
            display: flex;
            justify-content: center;
            align-items: center;
            box-shadow: 0 10px 25px rgba(0,0,0,0.15);
            cursor: pointer;
            transition: all 0.3s;
            border: 2px solid #ff6b8b;
        }

        .music-control:hover {
            transform: scale(1.15) rotate(15deg);
            background: white;
            box-shadow: 0 15px 30px rgba(255, 107, 139, 0.4);
        }

        .music-control i {
            font-size: 28px;
            color: #ff6b8b;
        }

        /* ===== å“åº”å¼è®¾è®¡ ===== */
        @media (max-width: 768px) {
            .gift-emoji {
                font-size: 90px;
            }
            
            .gift-text {
                font-size: 22px;
                padding: 8px 20px;
            }
            
            .buttons {
                flex-direction: column;
                gap: 25px;
            }
            
            .btn {
                padding: 16px 35px;
                font-size: 18px;
                min-width: 140px;
            }
            
            /* æ‰‹æœºç«¯æ»‘åŠ¨ä¼˜åŒ– */
            #scene-2 {
                padding: 20px 15px;
            }
            
            .letter-container {
                padding: 40px 25px;
                margin: 0 auto 40px auto;
                max-width: 95%;
            }
            
            .to-name {
                font-size: 28px;
            }
            
            .letter-content {
                font-size: 20px;
                padding: 0 10px;
            }
            
            .music-control {
                width: 60px;
                height: 60px;
                bottom: 20px;
                right: 20px;
            }
            
            .hint-box {
                padding: 30px 20px;
            }
            
            .hint-box h2 {
                font-size: 20px;
            }
        }
    </style>
</head>
<body>
    <!-- éŸ³ä¹æç¤ºå±‚ï¼ˆé¦–æ¬¡è®¿é—®æ˜¾ç¤ºï¼‰ -->
    <div id="music-hint">
        <div class="hint-box">
            <i class="fas fa-music"></i>
            <h2>ğŸµ å¼€å¯éŸ³ä¹ä½“éªŒ</h2>
            <p>ç‚¹å‡»ä¸‹æ–¹æŒ‰é’®å¼€å¯èƒŒæ™¯éŸ³ä¹<br>è·å¾—æœ€ä½³ç¤¼ç‰©ä½“éªŒ</p>
            <button class="hint-btn" id="enable-music-btn">
                å¼€å¯éŸ³ä¹å¹¶è¿›å…¥
            </button>
        </div>
    </div>

    <!-- ç¬¬ä¸€å¹•ï¼šç¤¼ç‰©é€‰æ‹© -->
    <div id="scene-1">
        <div class="gift-container">
            <div class="gift-emoji">ğŸ</div>
            <div class="gift-text">ç»™<span>æœ±å¥•éœ</span>çš„æ–°å¹´ç¤¼ç‰©ï¼Œæ˜¯å¦æ¥æ”¶ï¼Ÿ</div>
            <div class="buttons">
                <button class="btn btn-accept" id="accept-btn">æ¥ å— ğŸ’</button>
                <button class="btn btn-reject" id="reject-btn">æ‹’ ç» âœ–</button>
            </div>
        </div>
    </div>

    <!-- ç¬¬äºŒå¹•ï¼šä¿¡ä»¶é¡µé¢ -->
    <div id="scene-2">
        <canvas id="snow-canvas"></canvas>
        <canvas id="hearts-canvas"></canvas>
        
        <div class="letter-container">
            <div class="letter-header">
                <div class="ribbon">ğŸ€</div>
                <div class="to-name">to æœ±å¥•éœ</div>
                <div class="decoration-line"></div>
            </div>
            
            <div class="letter-content">
 è§ä¿¡ä¸å¦‚æ™¤ï¼Œå› ä¸ºæˆ‘ä»¬ä¸Šå­¦å¤©å¤©è§ğŸ˜‡
  è¿™æ˜¯æˆ‘ä»¬ä¸€èµ·è·¨çš„ç¬¬1ä¸ªå¹´ï¼Œè™½ç„¶æˆ‘ä»¬è®¤è¯†çš„æ—¶é—´ä¸é•¿ï¼Œä½†æˆ‘æ—¶å¸¸è§‰å¾—é‡è§ä½ å¾ˆå¹¸è¿ï¼Œæ„Ÿè°¢æ–°ä¸€è®©æˆ‘ä»¬ç›¸é‡
  åˆšè¿›24ç­é‚£ä¸€æ®µæ—¶é—´ï¼Œæˆ‘å¯¹ä½ å°è±¡åˆæ·±åˆä¸æ·±ï¼Œæ·±æ˜¯å› ä¸ºä½ çš„è‡ªæˆ‘ä»‹ç»ï¼Œå¾ˆæœ‰æ„æ€ï¼Œèƒ½å¬å‡ºæ¥ä½ æ˜¯ä¸ªå¤§æ–¹æœ‰è¶£çš„äººï¼Œä¸æ·±æ˜¯å› ä¸ºä½ ç»å¸¸ååœ¨åæ’ï¼Œæ‰€ä»¥å¯¹ä½ çŸ¥é“çš„ä¸å¤šğŸ™Œ
  æˆ‘å½“æ—¶åå‰é¢ï¼Œä¹Ÿæ²¡ä»€ä¹ˆäººæ­ç†æˆ‘ï¼Œæˆ‘ä¹Ÿæ²¡æ­ç†ä»€ä¹ˆäººï¼Œç”šè‡³å¯¹æˆ‘æ—è¾¹çš„äººé¡¶å¤šå°±åªèƒ½è¯´æ˜¯è®¤è¯†ï¼Œä½†ä¸ç†Ÿï¼Œæˆ‘è§‰å¾—ä¸èƒ½è¿™æ ·ï¼Œæ‰€æœ‰ä¸€æ¬¡ä½ ä»¬å‡†å¤‡è¿åŠ¨æ¥åŠ›èµ›æ—¶ï¼Œæˆ‘æäº†ä¸¤ä¸ªå»ºè®®ï¼Œç„¶åå°´å°¬çš„èµ°äº†ï¼Œå—¯ï¼Œå¯¹ï¼Œå› ä¸ºå¥½åƒå¹¶æ²¡æœ‰äººæ­ç†æˆ‘ï¼Œæ¯•ç«Ÿéƒ½ä¸è®¤è¯†æˆ‘ï¼Œæˆ–è€…è¯´åƒæŸäººè¯´çš„å¯¹æˆ‘å°è±¡ä¸å¥½ğŸ‘¹ï¼Œæˆ‘ä¸€ç›´ä»¥ä¸ºæˆ‘è¦è¿™ä¹ˆå¾…ä¸€ä¸ªæ•´ä¸ªé«˜ä¸€
  ç›´åˆ°æŸæ¬¡æˆ‘è·‘å»äº†åæ’ï¼Œä¸€å¼€å§‹æˆ‘ä¹Ÿä¸è‡ªåœ¨ï¼Œæˆ‘çœ‹ä½ ä¿©ç©ï¼Œæˆ‘ä¹Ÿæƒ³ç©ï¼Œæˆ‘åˆä¸æ•¢è¯´ï¼Œç›´åˆ°æ…¢æ…¢ç†Ÿèµ·æ¥å§ï¼Œæˆ‘å‘ç°ä½ æ˜¯ä¸ªç‰¹åˆ«å–„è‰¯åŒ…å®¹çš„äººï¼ˆæ–‡åŒ–ä½ï¼Œæ‰¾ä¸å‡ºæ›´åˆé€‚çš„è¯äº†ï¼‰ğŸ˜Š
  ä½ å°±è·Ÿé‚£ä¸ªå…¨è‡ªåŠ¨å¸å‹æœºä¸€æ ·ï¼Œè·Ÿä½ åœ¨ä¸€å—äººç¼˜éƒ½å˜å¥½äº†ï¼Œå› ä¸ºä½ ä¸Šå»è¯´è¯çš„æ—¶å€™ï¼Œæˆ‘ä¹Ÿèƒ½è·Ÿç€æ­ä¸Šä¸¤å¥ï¼Œä½ çš„å¤§æ–¹å¤–å‘å¯¹äººçš„çœŸçš„å¾ˆæœ‰å½±å“ğŸ§
  ä½ ç›´æ¥å»æ‰¾ç‹è¥¿æ´‹é‚£å›çœŸçš„ç»™æˆ‘éœ‡æƒŠäº†ï¼Œè¿˜èƒ½è¿™ä¹ˆåŠï¼Œå‹‡æ•¢æ­£ç›´çš„äººğŸ‘ä½†åŒæ—¶è¿˜æœ‰å¦ä¸€é¢ï¼Œä½ ä¼šç…§é¡¾äººçš„æƒ…ç»ªï¼Œä½ è¿˜ä¼šç»™æˆ‘è¿‡ç”Ÿæ—¥ğŸ¥³æˆ‘ç‰¹æ„ŸåŠ¨ï¼Œè¿™ç»å¯¹æ˜¯æœ€ç‰¹åˆ«çš„ä¸€å¹´ç”Ÿæ—¥
  å’Œä½ ç›¸å¤„çœŸçš„è®©äººæ”¾å¾—å¼€ï¼Œè¨€è¯­è¡Œä¸ºéƒ½è®©äººæ„Ÿè§‰ç‰¹æœ‰æ„æ€ï¼Œç‰¹è®©äººèˆ’å¿ƒå–œæ¬¢ï¼Œæœ‰è¿™æ ·çš„æœ±å¼ˆéœç»™æˆ‘å½“æœ‹å‹ï¼ŒçœŸæ˜¯ç¦æ°”ï¼Œä¹Ÿå¸Œæœ›ä½ èƒ½æ°¸è¿œè¿™ä¹ˆä¹è§‚å¼€å¿ƒğŸ€
  æ–°çš„2026å¹´ï¼Œå¸Œæœ›æœ±å¼ˆéœå¹´å¹´å¸¸ä¹ï¼Œå²å²æ¬¢æ„‰ï¼Œåœ¨æ˜¥å¤©å¾—å¿æ‰€æ„¿ï¼Œçœ‹æ˜¥é£ä½œåºï¼Œå€™é¸Ÿå—å½’ğŸŒ¸
  ä½ æ—¢è¦æ˜¯åˆ«äººçš„æŒä¸Šæ˜ç ï¼Œä¹Ÿè¦æ˜¯è‡ªå·±çš„ç‹¬å®¶çå®ğŸŒŸ
  æˆ‘ç›¸ä¿¡å³ä½¿åæ¥åˆ†äº†ç­ï¼Œæˆ‘ä»¬ä¹‹é—´ä¹Ÿä¸ä¼šé™Œç”Ÿï¼Œæ„¿æˆ‘ä»¬ï¼Œæ˜çŸ¥æ•…è¡Œï¼Œç»ˆæŠµå¤©æ˜
  æµ·é˜”å‡­é±¼è·ƒï¼Œå¤©é«˜ä»»é¸Ÿé£ğŸ‘‘
            </div>
            
            <div class="letter-footer">
                <div class="from-name">ä¸€ä¸€</div>
                <div class="date">2026å¹´1æœˆ1æ—¥</div>
            </div>
        </div>
    </div>

    <!-- éŸ³ä¹æ§åˆ¶ -->
    <div class="music-control" id="music-control">
        <i class="fas fa-pause"></i>
    </div>

    <!-- èƒŒæ™¯éŸ³ä¹ - æ¸©æŸ”å‹è°Šä¸»é¢˜å¤šæºå¤‡ç”¨ -->
    <audio id="bg-music" loop preload="auto">
        <!-- ä¸»é“¾æ¥ï¼šæ¸©æŸ”é’¢ç´ã€ŠA Thousand Yearsã€‹é’¢ç´ç‰ˆ -->
        <source src="https://cdn.pixabay.com/download/audio/2021/10/25/audio_c4c7d8c2f5.mp3?filename=a-thousand-years-piano-version-115571.mp3" type="audio/mpeg">
        
        <!-- å¤‡ç”¨1ï¼šæ¸©æš–å‰ä»–ã€ŠBest Friendã€‹ -->
        <source src="https://cdn.pixabay.com/download/audio/2022/03/10/audio_bb5c1cc43d.mp3?filename=acoustic-guitar-amp-piano-123235.mp3" type="audio/mpeg">
        
        <!-- å¤‡ç”¨2ï¼šè½»å¿«å°¤å…‹é‡Œé‡Œã€ŠSunny Dayã€‹ -->
        <source src="https://cdn.pixabay.com/download/audio/2022/01/18/audio_2f01c5e66a.mp3?filename=happy-ukulele-123229.mp3" type="audio/mpeg">
        
        <!-- å¤‡ç”¨3ï¼šè½»æŸ”æµè¡Œã€ŠMemoriesã€‹ -->
        <source src="https://assets.mixkit.co/music/preview/mixkit-memories-128.mp3" type="audio/mpeg">
        
        <!-- å¤‡ç”¨4ï¼šæ¸©é¦¨çº¯éŸ³ä¹ã€ŠFriends Foreverã€‹ -->
        <source src="https://files.freemusicarchive.org/storage-freemusicarchive-org/music/no_curator/Tours/Enthusiast/Tours_-_01_-_Enthusiast.mp3" type="audio/mpeg">
        
        æ‚¨çš„æµè§ˆå™¨ä¸æ”¯æŒéŸ³é¢‘æ’­æ”¾
    </audio>

    <script>
        // é¡µé¢å…ƒç´ 
        const musicHint = document.getElementById('music-hint');
        const scene1 = document.getElementById('scene-1');
        const scene2 = document.getElementById('scene-2');
        const acceptBtn = document.getElementById('accept-btn');
        const rejectBtn = document.getElementById('reject-btn');
        const musicControl = document.getElementById('music-control');
        const bgMusic = document.getElementById('bg-music');
        const musicIcon = musicControl.querySelector('i');
        const enableMusicBtn = document.getElementById('enable-music-btn');

        // éŸ³ä¹çŠ¶æ€
        let musicPlaying = false;
        let musicInitialized = false;

        // 1. é¡µé¢åŠ è½½åç«‹å³é™éŸ³è‡ªåŠ¨æ’­æ”¾ï¼ˆç»•è¿‡æµè§ˆå™¨é™åˆ¶ï¼‰
        window.addEventListener('load', () => {
            console.log('é¡µé¢åŠ è½½å®Œæˆï¼Œå°è¯•é™éŸ³è‡ªåŠ¨æ’­æ”¾...');
            
            // è®¾ç½®éŸ³é‡å¹¶é™éŸ³æ’­æ”¾
            bgMusic.volume = 0.4;
            bgMusic.muted = true;
            
            const playPromise = bgMusic.play();
            
            if (playPromise !== undefined) {
                playPromise.then(() => {
                    console.log('éŸ³ä¹é™éŸ³è‡ªåŠ¨æ’­æ”¾æˆåŠŸ');
                    musicInitialized = true;
                    
                    // æ£€æŸ¥æ˜¯å¦å·²ç»åŒæ„å¼€å¯éŸ³ä¹
                    const musicEnabled = localStorage.getItem('musicEnabled');
                    if (musicEnabled === 'true') {
                        // å¦‚æœä¹‹å‰å·²ç»åŒæ„ï¼Œç›´æ¥è·³è¿‡æç¤º
                        skipMusicHint();
                    }
                }).catch(error => {
                    console.log('é™éŸ³è‡ªåŠ¨æ’­æ”¾å¤±è´¥:', error);
                    // æ˜¾ç¤ºæç¤ºå±‚è®©ç”¨æˆ·æ‰‹åŠ¨å¼€å¯
                });
            }
        });

        // 2. ç”¨æˆ·ç‚¹å‡»"å¼€å¯éŸ³ä¹"æŒ‰é’®
        enableMusicBtn.addEventListener('click', () => {
            console.log('ç”¨æˆ·ç‚¹å‡»å¼€å¯éŸ³ä¹');
            
            // ç§»é™¤é™éŸ³
            bgMusic.muted = false;
            musicPlaying = true;
            musicIcon.className = 'fas fa-pause';
            
            // å­˜å‚¨ç”¨æˆ·é€‰æ‹©
            localStorage.setItem('musicEnabled', 'true');
            
            // æ·¡å‡ºæç¤ºå±‚
            musicHint.style.opacity = '0';
            setTimeout(() => {
                musicHint.style.display = 'none';
                scene1.style.display = 'flex';
                
                // å¦‚æœä¸æ˜¯iOSï¼Œç¡®ä¿éŸ³ä¹ç»§ç»­æ’­æ”¾
                if (!/iPad|iPhone|iPod/.test(navigator.userAgent)) {
                    bgMusic.play().then(() => {
                        console.log('éŸ³ä¹æ­£å¸¸æ’­æ”¾');
                    });
                }
            }, 500);
        });

        // è·³è¿‡éŸ³ä¹æç¤ºï¼ˆå¦‚æœä¹‹å‰å·²ç»åŒæ„ï¼‰
        function skipMusicHint() {
            musicHint.style.display = 'none';
            scene1.style.display = 'flex';
            bgMusic.muted = false;
            musicPlaying = true;
            musicIcon.className = 'fas fa-pause';
        }

        // 3. éŸ³ä¹æ§åˆ¶æŒ‰é’®
        musicControl.addEventListener('click', (e) => {
            e.stopPropagation();
            if (musicPlaying) {
                bgMusic.pause();
                musicIcon.className = 'fas fa-play';
            } else {
                bgMusic.play().then(() => {
                    musicIcon.className = 'fas fa-pause';
                });
            }
            musicPlaying = !musicPlaying;
        });

        // 4. æ‹’ç»æŒ‰é’®é€ƒè·‘æ•ˆæœ
        let rejectRunning = false;
        let rejectInterval = null;
        let speed = 5;

        function moveRejectButton() {
            if (!rejectRunning) return;
            
            const viewportWidth = window.innerWidth;
            const viewportHeight = window.innerHeight;
            const btnWidth = rejectBtn.offsetWidth;
            const btnHeight = rejectBtn.offsetHeight;
            
            let newX, newY;
            let attempts = 0;
            
            do {
                newX = Math.random() * (viewportWidth - btnWidth);
                newY = Math.random() * (viewportHeight - btnHeight);
                attempts++;
            } while (attempts < 10);
            
            rejectBtn.style.transition = `all ${0.3 + Math.random() * 0.4}s cubic-bezier(0.34, 1.56, 0.64, 1)`;
            rejectBtn.style.position = 'fixed';
            rejectBtn.style.left = newX + 'px';
            rejectBtn.style.top = newY + 'px';
            rejectBtn.style.transform = `rotate(${Math.random() * 20 - 10}deg)`;
            
            speed = Math.min(speed + 0.2, 15);
        }

        rejectBtn.addEventListener('click', () => {
            if (!rejectRunning) {
                rejectRunning = true;
                moveRejectButton();
                rejectInterval = setInterval(moveRejectButton, 800 - speed * 30);
                rejectBtn.innerHTML = 'æŠ“ä¸åˆ°æˆ‘ ğŸ˜œ';
                rejectBtn.style.background = 'linear-gradient(135deg, #ff4757, #ff3838)';
            }
        });

        rejectBtn.addEventListener('mouseover', () => {
            if (!rejectRunning) {
                moveRejectButton();
            }
        });

        // 5. æ¥å—æŒ‰é’®ç‚¹å‡»
        acceptBtn.addEventListener('click', () => {
            if (rejectInterval) {
                clearInterval(rejectInterval);
                rejectRunning = false;
            }
            
            acceptBtn.innerHTML = 'æ¥æ”¶ä¸­ ğŸ’–';
            acceptBtn.style.background = 'linear-gradient(135deg, #00d2ff, #3a7bd5)';
            
            setTimeout(() => {
                scene1.style.opacity = '0';
                scene1.style.transform = 'scale(1.1)';
                
                setTimeout(() => {
                    scene1.style.display = 'none';
                    scene2.style.display = 'block';  /* æ”¹ä¸ºblockä»¥æ”¯æŒæ»šåŠ¨ */
                    
                    setTimeout(() => {
                        scene2.style.opacity = '1';
                        
                        // ç¡®ä¿éŸ³ä¹æ’­æ”¾
                        if (!musicPlaying && musicInitialized) {
                            bgMusic.muted = false;
                            bgMusic.play().then(() => {
                                musicPlaying = true;
                                musicIcon.className = 'fas fa-pause';
                            });
                        }
                        
                        // å¯åŠ¨ç‰¹æ•ˆ
                        initSnow();
                        initHearts();
                        
                        // è‡ªåŠ¨æ»šåŠ¨åˆ°é¡¶éƒ¨ï¼ˆç¡®ä¿èƒ½çœ‹åˆ°å¼€å¤´ï¼‰
                        setTimeout(() => {
                            scene2.scrollTop = 0;
                        }, 100);
                    }, 100);
                }, 600);
            }, 300);
        });

        // 6. æ·»åŠ é—ªçƒæ˜Ÿæ˜Ÿæ•ˆæœ
        function createSparkles() {
            const container = document.querySelector('.gift-container');
            for (let i = 0; i < 15; i++) {
                const sparkle = document.createElement('div');
                sparkle.className = 'sparkle';
                sparkle.style.cssText = `
                    --tx: ${Math.random() * 100 - 50}px;
                    --ty: ${Math.random() * 100 - 50}px;
                    left: ${Math.random() * 100}%;
                    top: ${Math.random() * 100}%;
                    animation-delay: ${Math.random() * 2}s;
                    background: ${i % 3 === 0 ? 'gold' : i % 3 === 1 ? '#ff6b8b' : '#38f9d7'};
                `;
                container.appendChild(sparkle);
            }
        }

        // 7. é£˜é›ªæ•ˆæœ
        function initSnow() {
            const canvas = document.getElementById('snow-canvas');
            const ctx = canvas.getContext('2d');
            let snowflakes = [];
            
            function resizeCanvas() {
                canvas.width = window.innerWidth;
                canvas.height = window.innerHeight;
            }
            
            class Snowflake {
                constructor() {
                    this.x = Math.random() * canvas.width;
                    this.y = Math.random() * canvas.height - canvas.height;
                    this.size = Math.random() * 5 + 2;
                    this.speed = Math.random() * 1.2 + 0.5;
                    this.opacity = Math.random() * 0.6 + 0.2;
                    this.wind = Math.random() * 0.8 - 0.4;
                    this.swing = Math.random() * 0.05;
                    this.swingOffset = Math.random() * Math.PI * 2;
                }
                
                update() {
                    this.y += this.speed;
                    this.x += this.wind + Math.sin(Date.now() * 0.001 + this.swingOffset) * this.swing;
                    
                    if (this.y > canvas.height) {
                        this.y = -10;
                        this.x = Math.random() * canvas.width;
                    }
                    if (this.x > canvas.width) this.x = 0;
                    if (this.x < 0) this.x = canvas.width;
                }
                
                draw() {
                    ctx.beginPath();
                    ctx.arc(this.x, this.y, this.size, 0, Math.PI * 2);
                    ctx.fillStyle = `rgba(255, 255, 255, ${this.opacity})`;
                    ctx.fill();
                }
            }
            
            function createSnowflakes() {
                snowflakes = [];
                for (let i = 0; i < 200; i++) {
                    snowflakes.push(new Snowflake());
                }
            }
            
            function animateSnow() {
                ctx.clearRect(0, 0, canvas.width, canvas.height);
                snowflakes.forEach(flake => {
                    flake.update();
                    flake.draw();
                });
                requestAnimationFrame(animateSnow);
            }
            
            resizeCanvas();
            createSnowflakes();
            animateSnow();
            
            window.addEventListener('resize', () => {
                resizeCanvas();
                createSnowflakes();
            });
        }

        // 8. çˆ±å¿ƒæ•ˆæœ
        function initHearts() {
            const canvas = document.getElementById('hearts-canvas');
            const ctx = canvas.getContext('2d');
            let hearts = [];
            
            function resizeCanvas() {
                canvas.width = window.innerWidth;
                canvas.height = window.innerHeight;
            }
            
            class Heart {
                constructor() {
                    this.x = Math.random() * canvas.width;
                    this.y = canvas.height + 20;
                    this.size = Math.random() * 12 + 8;
                    this.speed = Math.random() * 1.5 + 0.5;
                    this.opacity = Math.random() * 0.5 + 0.2;
                    this.color = `rgba(255, ${Math.floor(Math.random() * 80 + 100)}, ${Math.floor(Math.random() * 120 + 180)}, ${this.opacity})`;
                    this.wave = Math.random() * 0.8;
                    this.waveSpeed = Math.random() * 0.03 + 0.01;
                    this.waveOffset = Math.random() * Math.PI * 2;
                    this.rotation = Math.random() * Math.PI * 2;
                    this.rotateSpeed = Math.random() * 0.02 - 0.01;
                }
                
                update() {
                    this.y -= this.speed;
                    this.x += Math.sin(Date.now() * this.waveSpeed + this.waveOffset) * this.wave;
                    this.rotation += this.rotateSpeed;
                    
                    if (this.y < -30) {
                        this.y = canvas.height + 20;
                        this.x = Math.random() * canvas.width;
                    }
                }
                
                draw() {
                    ctx.save();
                    ctx.globalAlpha = this.opacity;
                    ctx.fillStyle = this.color;
                    ctx.translate(this.x, this.y);
                    ctx.rotate(this.rotation);
                    
                    ctx.beginPath();
                    const topCurveHeight = this.size * 0.3;
                    ctx.moveTo(0, topCurveHeight);
                    
                    ctx.bezierCurveTo(0, 0, -this.size, 0, -this.size, topCurveHeight);
                    ctx.bezierCurveTo(-this.size, this.size * 0.6, 0, this.size * 0.9, 0, this.size);
                    ctx.bezierCurveTo(0, this.size * 0.9, this.size, this.size * 0.6, this.size, topCurveHeight);
                    ctx.bezierCurveTo(this.size, 0, 0, 0, 0, topCurveHeight);
                    
                    ctx.closePath();
                    ctx.fill();
                    ctx.restore();
                }
            }
            
            function createHearts() {
                hearts = [];
                for (let i = 0; i < 40; i++) {
                    hearts.push(new Heart());
                }
            }
            
            function animateHearts() {
                ctx.clearRect(0, 0, canvas.width, canvas.height);
                hearts.forEach(heart => {
                    heart.update();
                    heart.draw();
                });
                requestAnimationFrame(animateHearts);
            }
            
            resizeCanvas();
            createHearts();
            animateHearts();
            
            window.addEventListener('resize', () => {
                resizeCanvas();
                createHearts();
            });
            
            setInterval(() => {
                if (hearts.length < 60) {
                    hearts.push(new Heart());
                }
            }, 1500);
        }

        // 9. åˆå§‹åŒ–é¡µé¢
        window.addEventListener('load', () => {
            createSparkles();
            
            // æ£€æŸ¥æ˜¯å¦ä¹‹å‰å·²ç»åŒæ„å¼€å¯éŸ³ä¹
            if (localStorage.getItem('musicEnabled') === 'true') {
                skipMusicHint();
            }
        });
    </script>
</body>
</html>
